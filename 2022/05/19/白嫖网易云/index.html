<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="项目分析首先，感谢这位大佬的博客：（狗头保命） 『Python』网易云音乐API爬虫 Am0xil的博客-CSDN博客 网易云音乐搜索接口  网易云官方 API 接口地址：https:&#x2F;&#x2F;music.163.com 大佬使用的 API：https:&#x2F;&#x2F;music.163.com&#x2F;weapi&#x2F;cloudsearch&#x2F;get&#x2F;web?csrf_token&#x3D;  这个 API 是大佬用 F12 找的 我也">
<meta property="og:type" content="article">
<meta property="og:title" content="不务正业系列：白嫖网易云（偶尔更新）">
<meta property="og:url" content="http://example.com/2022/05/19/%E7%99%BD%E5%AB%96%E7%BD%91%E6%98%93%E4%BA%91/index.html">
<meta property="og:site_name" content="Pwn进你的心">
<meta property="og:description" content="项目分析首先，感谢这位大佬的博客：（狗头保命） 『Python』网易云音乐API爬虫 Am0xil的博客-CSDN博客 网易云音乐搜索接口  网易云官方 API 接口地址：https:&#x2F;&#x2F;music.163.com 大佬使用的 API：https:&#x2F;&#x2F;music.163.com&#x2F;weapi&#x2F;cloudsearch&#x2F;get&#x2F;web?csrf_token&#x3D;  这个 API 是大佬用 F12 找的 我也">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/2022/05/19/%E7%99%BD%E5%AB%96%E7%BD%91%E6%98%93%E4%BA%91/1652889291490-1652970678978.png">
<meta property="og:image" content="http://example.com/2022/05/19/%E7%99%BD%E5%AB%96%E7%BD%91%E6%98%93%E4%BA%91/1652892593720-1652970678978.png">
<meta property="og:image" content="http://example.com/2022/05/19/%E7%99%BD%E5%AB%96%E7%BD%91%E6%98%93%E4%BA%91/1652892892160-1652970678978.png">
<meta property="og:image" content="http://example.com/2022/05/19/%E7%99%BD%E5%AB%96%E7%BD%91%E6%98%93%E4%BA%91/1652892407410-1652970678978.png">
<meta property="og:image" content="http://example.com/2022/05/19/%E7%99%BD%E5%AB%96%E7%BD%91%E6%98%93%E4%BA%91/1652893595871-1652970678978.png">
<meta property="og:image" content="http://example.com/2022/05/19/%E7%99%BD%E5%AB%96%E7%BD%91%E6%98%93%E4%BA%91/1652894215310-1652970678978.png">
<meta property="og:image" content="http://example.com/2022/05/19/%E7%99%BD%E5%AB%96%E7%BD%91%E6%98%93%E4%BA%91/1652895300160-1652970678978.png">
<meta property="og:image" content="http://example.com/2022/05/19/%E7%99%BD%E5%AB%96%E7%BD%91%E6%98%93%E4%BA%91/1652932443142-1652970678978.png">
<meta property="og:image" content="http://example.com/2022/05/19/%E7%99%BD%E5%AB%96%E7%BD%91%E6%98%93%E4%BA%91/1652932460709-1652970678978.png">
<meta property="og:image" content="http://example.com/2022/05/19/%E7%99%BD%E5%AB%96%E7%BD%91%E6%98%93%E4%BA%91/1652970459276.png">
<meta property="article:published_time" content="2022-05-19T03:57:59.000Z">
<meta property="article:modified_time" content="2022-05-19T14:31:34.000Z">
<meta property="article:author" content="yhellow">
<meta property="article:tag" content="Netease">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/2022/05/19/%E7%99%BD%E5%AB%96%E7%BD%91%E6%98%93%E4%BA%91/1652889291490-1652970678978.png">

<link rel="canonical" href="http://example.com/2022/05/19/%E7%99%BD%E5%AB%96%E7%BD%91%E6%98%93%E4%BA%91/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>不务正业系列：白嫖网易云（偶尔更新） | Pwn进你的心</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Pwn进你的心</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/05/19/%E7%99%BD%E5%AB%96%E7%BD%91%E6%98%93%E4%BA%91/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="yhellow">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Pwn进你的心">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          不务正业系列：白嫖网易云（偶尔更新）
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2022-05-19 11:57:59 / Modified: 22:31:34" itemprop="dateCreated datePublished" datetime="2022-05-19T11:57:59+08:00">2022-05-19</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/NoMaoWork/" itemprop="url" rel="index"><span itemprop="name">NoMaoWork</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="Views" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span id="busuanzi_value_page_pv"></span>
            </span>
            <span class="post-meta-item" title="Symbols count in article">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
              <span>22k</span>
            </span>
            <span class="post-meta-item" title="Reading time">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
              <span>20 mins.</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h2 id="项目分析"><a href="#项目分析" class="headerlink" title="项目分析"></a>项目分析</h2><p>首先，感谢这位大佬的博客：（狗头保命）</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/zgbzbl/article/details/107773755">『Python』网易云音乐API爬虫 Am0xil的博客-CSDN博客 网易云音乐搜索接口</a> </p>
<p>网易云官方 API 接口地址：<a target="_blank" rel="noopener" href="https://music.163.com">https://music.163.com</a></p>
<p>大佬使用的 API：<a target="_blank" rel="noopener" href="https://music.163.com/weapi/cloudsearch/get/web?csrf_token=">https://music.163.com/weapi/cloudsearch/get/web?csrf_token=</a></p>
<ul>
<li>这个 API 是大佬用 F12 找的</li>
<li>我也找了找，没有找到</li>
</ul>
<img src="/2022/05/19/%E7%99%BD%E5%AB%96%E7%BD%91%E6%98%93%E4%BA%91/1652889291490-1652970678978.png" class width="1652889291490"> 
<ul>
<li>当时找到了“web?csrf_token”，但是没有发现歌曲的下载链接</li>
</ul>
<p>这里我先简述一下服务器请求机制：（之前在CSapp中学到过，也当是复习了吧）</p>
<p><strong>服务器请求</strong></p>
<p>一般的请求消息如下代码所示：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">GET /home.html HTTP/1.0 <span class="comment">&lt;!-- 请求消息行 --&gt;</span></span><br><span class="line">Accept: */* <span class="comment">&lt;!-- 请求消息头 --&gt;</span></span><br><span class="line">Host: localhost:GET /home.html HTTP/1.0</span><br><span class="line">Accept: */*</span><br><span class="line">Host: localhost:GET /home.html HTTP/1.0</span><br><span class="line">Accept: */*</span><br><span class="line">Host: localhost:</span><br><span class="line">User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:10.0.3) Gecko/20120305 Firefox/10.0.3</span><br><span class="line">Connection: close</span><br><span class="line">Proxy-Connection: close</span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span> <span class="comment">&lt;!-- 消息正文 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span><span class="tag">&lt;<span class="name">title</span>&gt;</span>test<span class="tag">&lt;/<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">align</span>=<span class="string">&quot;middle&quot;</span> <span class="attr">src</span>=<span class="string">&quot;godzilla.gif&quot;</span>&gt;</span></span><br><span class="line">Dave O&#x27;Hallaron</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>请求消息行：请求消息的第一行为请求消息行</p>
<ul>
<li>例如：GET  /test/test.html  HTTP/1.1</li>
<li>GET 为请求方式，请求方式分为：Get（默认）、POST、DELETE、HEAD等<ul>
<li>GET：明文传输 不安全，数据量有限，不超过1kb</li>
<li>POST：暗文传输，安全，数据量没有限制</li>
</ul>
</li>
<li>/test/test.html 为URI，统一资源标识符</li>
<li>HTTP/1.1 为协议版本</li>
</ul>
</li>
<li><p>请求消息头：从第二行开始到空白行统称为请求消息头（包含各种信息）</p>
</li>
<li><p>消息正文：当请求方式是[POST]方式时，才能看见消息正文，消息正文就是要传输的一些数据，如果没有数据需要传输时，消息正文为空</p>
</li>
</ul>
<p><strong>服务器响应</strong></p>
<p>一般的响应如下代码所示：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.0 200 OK <span class="comment">&lt;!-- 响应消息行 --&gt;</span></span><br><span class="line">Server: Tiny Web Server <span class="comment">&lt;!-- 响应消息头 --&gt;</span></span><br><span class="line">Content-length: 120</span><br><span class="line">Content-type: text/html</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span> <span class="comment">&lt;!-- 响应正文 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span><span class="tag">&lt;<span class="name">title</span>&gt;</span>test<span class="tag">&lt;/<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">align</span>=<span class="string">&quot;middle&quot;</span> <span class="attr">src</span>=<span class="string">&quot;godzilla.gif&quot;</span>&gt;</span></span><br><span class="line">Dave O&#x27;Hallaron</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span> </span><br></pre></td></tr></table></figure>
<ul>
<li>响应消息行：第一行响应消息为响应消息行<ul>
<li>例如：HTTP/1.0 200 OK</li>
<li>HTTP/1.0 为协议版本</li>
<li>200 为响应状态码，常用的响应状态码有40余种，这里我们仅列出几种，详细请看：<ul>
<li>200：一切正常</li>
<li>302/307：临时重定向</li>
<li>304：未修改，客户端可以从缓存中读取数据，无需从服务器读取</li>
<li>404：服务器上不存在客户端所请求的资源</li>
<li>500：服务器内部错误</li>
</ul>
</li>
<li>OK 为状态码描述</li>
</ul>
</li>
<li>响应消息头：和请求消息头类似</li>
<li>响应正文：即网页的源代码（F12可查看）</li>
</ul>
<p>先看看大佬对请求的处理：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_music_list</span>(<span class="params">params, encSecKey</span>):</span></span><br><span class="line">    url = <span class="string">&quot;https://music.163.com/weapi/cloudsearch/get/web?csrf_token=&quot;</span></span><br><span class="line"></span><br><span class="line">    payload = <span class="string">&#x27;params=&#x27;</span> + parse.quote(params) + <span class="string">&#x27;&amp;encSecKey=&#x27;</span> + parse.quote(encSecKey)</span><br><span class="line">    headers = &#123;</span><br><span class="line">        <span class="string">&#x27;authority&#x27;</span>: <span class="string">&#x27;music.163.com&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;user-agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;content-type&#x27;</span>: <span class="string">&#x27;application/x-www-form-urlencoded&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;accept&#x27;</span>: <span class="string">&#x27;*/*&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;origin&#x27;</span>: <span class="string">&#x27;https://music.163.com&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;sec-fetch-site&#x27;</span>: <span class="string">&#x27;same-origin&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;sec-fetch-mode&#x27;</span>: <span class="string">&#x27;cors&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;sec-fetch-dest&#x27;</span>: <span class="string">&#x27;empty&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;referer&#x27;</span>: <span class="string">&#x27;https://music.163.com/search/&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;accept-language&#x27;</span>: <span class="string">&#x27;zh-CN,zh;q=0.9&#x27;</span>,</span><br><span class="line">    &#125;</span><br><span class="line">    response = requests.request(<span class="string">&quot;POST&quot;</span>, url, headers=headers, data=payload)</span><br><span class="line">    <span class="keyword">return</span> response.text</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过歌曲的id获取播放链接</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_reply</span>(<span class="params">params, encSecKey</span>):</span></span><br><span class="line">    url = <span class="string">&quot;https://music.163.com/weapi/song/enhance/player/url/v1?csrf_token=&quot;</span></span><br><span class="line">    payload = <span class="string">&#x27;params=&#x27;</span> + parse.quote(params) + <span class="string">&#x27;&amp;encSecKey=&#x27;</span> + parse.quote(encSecKey)</span><br><span class="line">    headers = &#123;</span><br><span class="line">        <span class="string">&#x27;authority&#x27;</span>: <span class="string">&#x27;music.163.com&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;user-agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;content-type&#x27;</span>: <span class="string">&#x27;application/x-www-form-urlencoded&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;accept&#x27;</span>: <span class="string">&#x27;*/*&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;origin&#x27;</span>: <span class="string">&#x27;https://music.163.com&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;sec-fetch-site&#x27;</span>: <span class="string">&#x27;same-origin&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;sec-fetch-mode&#x27;</span>: <span class="string">&#x27;cors&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;sec-fetch-dest&#x27;</span>: <span class="string">&#x27;empty&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;referer&#x27;</span>: <span class="string">&#x27;https://music.163.com/&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;accept-language&#x27;</span>: <span class="string">&#x27;zh-CN,zh;q=0.9&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    response = requests.request(<span class="string">&quot;POST&quot;</span>, url, headers=headers, data=payload)</span><br><span class="line">    <span class="keyword">return</span> response.text</span><br></pre></td></tr></table></figure>
<ul>
<li>requests.request(method,url,**kwargs) 的参数：<ul>
<li>method：请求类型（这里是”POST”）</li>
<li>url：请求对象的链接（这里是目标 API）</li>
<li>headers：请求头，直接 F12 查看，上面有什么条目直接抄<ul>
<li>PS：我 F12 看到的与作者代码中有不同的地方，但不影响结果</li>
</ul>
</li>
<li>data：字典、字节序列或文件对象，作为 Requests 的内容 </li>
</ul>
</li>
<li>最后返回服务器响应</li>
</ul>
<p>大佬这两个函数就是实现了 “获取歌曲列表，获取歌曲播放链接” 的功能（就是 url 不同）</p>
<ul>
<li>在查找界面 F12 截下的图（这个API和大佬用的不一样，爬取的歌单少一点）</li>
</ul>
<img src="/2022/05/19/%E7%99%BD%E5%AB%96%E7%BD%91%E6%98%93%E4%BA%91/1652892593720-1652970678978.png" class width="1652892593720">  
<ul>
<li>在播放界面 F12 截下的图（不知道大佬是怎么断定它就是播放链接的）</li>
</ul>
<img src="/2022/05/19/%E7%99%BD%E5%AB%96%E7%BD%91%E6%98%93%E4%BA%91/1652892892160-1652970678978.png" class width="1652892892160">  
<ul>
<li><p>请求头部分截取（主要是 cookie 太长了~）</p>
<img src="/2022/05/19/%E7%99%BD%E5%AB%96%E7%BD%91%E6%98%93%E4%BA%91/1652892407410-1652970678978.png" class width="1652892407410">  
</li>
</ul>
<p>要说大佬最亮眼的地方，就是对网易云加密算法的破解了（“params”和“encSecKey”）</p>
<p>点开 <strong>Headers</strong> 后我们可以发现，除了传统的请求头参数外，本次请求还携带了一个 <strong>Form</strong> 表单，其中有两个参数，分别是 <strong>params</strong> 和 <strong>encSecKey</strong> </p>
<img src="/2022/05/19/%E7%99%BD%E5%AB%96%E7%BD%91%E6%98%93%E4%BA%91/1652893595871-1652970678978.png" class width="1652893595871"> 
<p>具体来说，是用了 AES 和一些自创的加密算法，本人以前是搞逆向的，所以这些东西还是能应付，就是 JavaScript 有点恼火</p>
<p>搜索 encSecKey 我找到的就是这么一堆东西：</p>
<img src="/2022/05/19/%E7%99%BD%E5%AB%96%E7%BD%91%E6%98%93%E4%BA%91/1652894215310-1652970678978.png" class width="1652894215310"> 
<p>在网上找个格式化网站进行格式化：</p>
<img src="/2022/05/19/%E7%99%BD%E5%AB%96%E7%BD%91%E6%98%93%E4%BA%91/1652895300160-1652970678978.png" class width="1652895300160"> 
<p>搜索“encSecKey”：（最好不要搜索“params”）</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> bKB0x = <span class="built_in">window</span>.asrsea(<span class="built_in">JSON</span>.stringify(i1x), buV7O([<span class="string">&quot;流泪&quot;</span>, <span class="string">&quot;强&quot;</span>]), buV7O(Rg9X.md), buV7O([<span class="string">&quot;爱心&quot;</span>, <span class="string">&quot;女孩&quot;</span>, <span class="string">&quot;惊恐&quot;</span>, <span class="string">&quot;大笑&quot;</span>]));</span><br><span class="line">e1x.data = j1x.cr2x(&#123;</span><br><span class="line">	<span class="attr">params</span>: bKB0x.encText,</span><br><span class="line">	<span class="attr">encSecKey</span>: bKB0x.encSecKey</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<ul>
<li>把 window.asrsea 实例化为 bKB0x，然后调用其中的方法“encText”，“encSecKey”</li>
</ul>
<p>搜索“asrsea”：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">d</span>(<span class="params">d, e, f, g</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">var</span> h = &#123;&#125;,</span><br><span class="line">		i = a(<span class="number">16</span>);</span><br><span class="line">	<span class="keyword">return</span> h.encText = b(d, g), </span><br><span class="line">           h.encText = b(h.encText, i), </span><br><span class="line">           h.encSecKey = c(i, e, f), </span><br><span class="line">           h</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">window</span>.asrsea = d, <span class="built_in">window</span>.ecnonasr = e</span><br></pre></td></tr></table></figure>
<ul>
<li>定义“encText”函数：<ul>
<li>利用“a(16)”获取“i”</li>
<li>进行第一次“b”算法</li>
<li>把“b”算法的结果和“i”作为参数，再进行一次“b”算法</li>
</ul>
</li>
<li>定义“encSecKey”函数：<ul>
<li>利用“a(16)”获取“i”</li>
<li>进行一次“c”算法</li>
</ul>
</li>
</ul>
<p>“a”算法的实现：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params">a</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">var</span> d, e, b = <span class="string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&quot;</span>,</span><br><span class="line">		c = <span class="string">&quot;&quot;</span>;</span><br><span class="line">	<span class="keyword">for</span> (d = <span class="number">0</span>; a &gt; d; d += <span class="number">1</span>) e = <span class="built_in">Math</span>.random() * b.length, e = <span class="built_in">Math</span>.floor(e), c += b.charAt(e);</span><br><span class="line">	<span class="keyword">return</span> c</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>从大小写英文字母以及10个数字中随机抽取16个字符拼接成一个新的字符串返回结果 </li>
</ul>
<p>“b”算法的实现：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">b</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">var</span> c = CryptoJS.enc.Utf8.parse(b),</span><br><span class="line">		d = CryptoJS.enc.Utf8.parse(<span class="string">&quot;0102030405060708&quot;</span>),</span><br><span class="line">		e = CryptoJS.enc.Utf8.parse(a),</span><br><span class="line">		f = CryptoJS.AES.encrypt(e, c, &#123;</span><br><span class="line">			<span class="attr">iv</span>: d,</span><br><span class="line">			<span class="attr">mode</span>: CryptoJS.mode.CBC</span><br><span class="line">		&#125;);</span><br><span class="line">	<span class="keyword">return</span> f.toString()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>通过 <strong>CBC</strong> 模式进行 <strong>AES</strong> 加密，将传入的 a 参数和 b 参数分别作为需要加密的内容和密钥，iv偏移量为一个固定的字符串“0102030405060708”</li>
</ul>
<p>“c”算法的实现：（前两个还好，这一串代码直接给我干沉默了…）</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">c</span>(<span class="params">a, b, c</span>) </span>&#123;</span><br><span class="line">	<span class="keyword">var</span> d, e;</span><br><span class="line">	<span class="keyword">return</span> setMaxDigits(<span class="number">131</span>), </span><br><span class="line">           d = <span class="keyword">new</span> RSAKeyPair(b, <span class="string">&quot;&quot;</span>, c), </span><br><span class="line">           e = encryptedString(d, a)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">RSAKeyPair</span>(<span class="params">a, b, c</span>) </span>&#123;</span><br><span class="line">       <span class="built_in">this</span>.e = biFromHex(a), </span><br><span class="line">       <span class="built_in">this</span>.d = biFromHex(b), </span><br><span class="line">       <span class="built_in">this</span>.m = biFromHex(c),</span><br><span class="line">       <span class="built_in">this</span>.chunkSize = <span class="number">2</span> * biHighIndex(<span class="built_in">this</span>.m), </span><br><span class="line">       <span class="built_in">this</span>.radix = <span class="number">16</span>,</span><br><span class="line">       <span class="built_in">this</span>.barrett = <span class="keyword">new</span> BarrettMu(<span class="built_in">this</span>.m)</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">encryptedString</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">       <span class="keyword">for</span> (<span class="keyword">var</span> f, g, h, i, j, k, l, c = <span class="keyword">new</span> <span class="built_in">Array</span>, d = b.length, e = <span class="number">0</span>; d &gt; e;) c[e] = b.charCodeAt(e), e++;</span><br><span class="line">       <span class="keyword">for</span> (; <span class="number">0</span> != c.length % a.chunkSize;) c[e++] = <span class="number">0</span>;</span><br><span class="line">       <span class="keyword">for</span> (f = c.length, g = <span class="string">&quot;&quot;</span>, e = <span class="number">0</span>; f &gt; e; e += a.chunkSize) &#123;</span><br><span class="line">           <span class="keyword">for</span> (j = <span class="keyword">new</span> <span class="built_in">BigInt</span>, h = <span class="number">0</span>, i = e; i &lt; e + a.chunkSize; ++h) j.digits[h] = c[i++], j.digits[h] += c[i++] &lt;&lt; <span class="number">8</span>;</span><br><span class="line">           k = a.barrett.powMod(j, a.e), l = <span class="number">16</span> == a.radix ? biToHex(k) : biToString(k, a.radix), g += l + <span class="string">&quot; &quot;</span></span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">return</span> g.substring(<span class="number">0</span>, g.length - <span class="number">1</span>)</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<p>最后提一下这些函数的参数：（由于我不会断点调试，这里就不展示过程了）</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">d：&#123;<span class="string">&quot;hlpretag&quot;</span>:<span class="string">&quot;&lt;span class=\&quot;s-fc7\&quot;&gt;&quot;</span>,<span class="string">&quot;hlposttag&quot;</span>:<span class="string">&quot;&lt;/span&gt;&quot;</span>,<span class="string">&quot;s&quot;</span>:<span class="string">&quot;Lily&quot;</span>,<span class="string">&quot;type&quot;</span>:<span class="string">&quot;1&quot;</span>,<span class="string">&quot;offset&quot;</span>:<span class="string">&quot;0&quot;</span>,<span class="string">&quot;total&quot;</span>:<span class="string">&quot;true&quot;</span>,<span class="string">&quot;limit&quot;</span>:<span class="string">&quot;30&quot;</span>,<span class="string">&quot;csrf_token&quot;</span>:<span class="string">&quot;&quot;</span>&#125;</span><br><span class="line">e：<span class="string">&quot;010001&quot;</span></span><br><span class="line">f：<span class="string">&quot;00e0b509f6259df8642dbc35662901477df22677ec152b5ff68ace615bb7b725152b3ab17a876aea8a5aa76d2e417629ec4ee341f56135fccf695280104e0312ecbda92557c93870114af6c9d05c4f7f0c3685b7a46bee255932575cce10b424d813cfe4875d3e82047b97ddef52741d546b8e289dc6935b3ece0462db0a22b8e7&quot;</span></span><br><span class="line">g：<span class="string">&quot;0CoJUm6Qyw8W8jud&quot;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>参数 <strong>e，f，g</strong> 始终保持不表，由此可见它们是3个常量</li>
<li>只是参数 <strong>d</strong> 中的歌曲名称在变化</li>
</ul>
<p>理解完大佬的代码后，我在他的基础上进行了修改：</p>
<h2 id="白嫖网易云-V1-0"><a href="#白嫖网易云-V1-0" class="headerlink" title="白嫖网易云_V1.0"></a>白嫖网易云_V1.0</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> parse</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> webbrowser</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Music</span>():</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_random</span>(<span class="params">self</span>):</span></span><br><span class="line">        random_str = <span class="string">&#x27;&#x27;</span>.join(random.sample(string.ascii_letters + string.digits, <span class="number">16</span>))</span><br><span class="line">        <span class="keyword">return</span> random_str</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">len_change</span>(<span class="params">self,text</span>):</span></span><br><span class="line">        pad = <span class="number">16</span> - <span class="built_in">len</span>(text) % <span class="number">16</span></span><br><span class="line">        text = text + pad * <span class="built_in">chr</span>(pad)</span><br><span class="line">        text = text.encode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> text</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">aes</span>(<span class="params">self,text, key</span>):</span></span><br><span class="line">        iv = <span class="string">b&#x27;0102030405060708&#x27;</span></span><br><span class="line">        text = self.len_change(text)</span><br><span class="line">        cipher = AES.new(key.encode(), AES.MODE_CBC, iv)</span><br><span class="line">        encrypted = cipher.encrypt(text)</span><br><span class="line">        encrypt = base64.b64encode(encrypted).decode()</span><br><span class="line">        <span class="keyword">return</span> encrypt</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">b</span>(<span class="params">self,text, <span class="built_in">str</span></span>):</span></span><br><span class="line">        first_data = self.aes(text, <span class="string">&#x27;0CoJUm6Qyw8W8jud&#x27;</span>)</span><br><span class="line">        second_data = self.aes(first_data, <span class="built_in">str</span>)</span><br><span class="line">        <span class="keyword">return</span> second_data</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">c</span>(<span class="params">self,text</span>):</span></span><br><span class="line">        e = <span class="string">&#x27;010001&#x27;</span></span><br><span class="line">        f = <span class="string">&#x27;00e0b509f6259df8642dbc35662901477df22677ec152b5ff68ace615bb7b725152b3ab17a876aea8a5aa76d2e417629ec4ee341f56135fccf695280104e0312ecbda92557c93870114af6c9d05c4f7f0c3685b7a46bee255932575cce10b424d813cfe4875d3e82047b97ddef52741d546b8e289dc6935b3ece0462db0a22b8e7&#x27;</span></span><br><span class="line">        text = text[::-<span class="number">1</span>]</span><br><span class="line">        result = <span class="built_in">pow</span>(<span class="built_in">int</span>(binascii.hexlify(text.encode()), <span class="number">16</span>), <span class="built_in">int</span>(e, <span class="number">16</span>), <span class="built_in">int</span>(f, <span class="number">16</span>))</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">format</span>(result, <span class="string">&#x27;x&#x27;</span>).zfill(<span class="number">131</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_final_param</span>(<span class="params">self,text, <span class="built_in">str</span></span>):</span></span><br><span class="line">        params = self.b(text, <span class="built_in">str</span>)</span><br><span class="line">        encSecKey = self.c(<span class="built_in">str</span>)</span><br><span class="line">        <span class="keyword">return</span> &#123;<span class="string">&#x27;params&#x27;</span>: params, <span class="string">&#x27;encSecKey&#x27;</span>: encSecKey&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_music_list</span>(<span class="params">self,params, encSecKey</span>):</span></span><br><span class="line">        url = <span class="string">&quot;https://music.163.com/weapi/cloudsearch/get/web?csrf_token=&quot;</span></span><br><span class="line"></span><br><span class="line">        payload = <span class="string">&#x27;params=&#x27;</span> + parse.quote(params) + <span class="string">&#x27;&amp;encSecKey=&#x27;</span> + parse.quote(encSecKey)</span><br><span class="line">        headers = &#123;</span><br><span class="line">            <span class="string">&#x27;authority&#x27;</span>: <span class="string">&#x27;music.163.com&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;user-agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;content-type&#x27;</span>: <span class="string">&#x27;application/x-www-form-urlencoded&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;accept&#x27;</span>: <span class="string">&#x27;*/*&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;origin&#x27;</span>: <span class="string">&#x27;https://music.163.com&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;sec-fetch-site&#x27;</span>: <span class="string">&#x27;same-origin&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;sec-fetch-mode&#x27;</span>: <span class="string">&#x27;cors&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;sec-fetch-dest&#x27;</span>: <span class="string">&#x27;empty&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;referer&#x27;</span>: <span class="string">&#x27;https://music.163.com/search/&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;accept-language&#x27;</span>: <span class="string">&#x27;zh-CN,zh;q=0.9&#x27;</span>,</span><br><span class="line">        &#125;</span><br><span class="line">        response = requests.request(<span class="string">&quot;POST&quot;</span>, url, headers=headers, data=payload)</span><br><span class="line">        <span class="keyword">return</span> response.text</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_reply</span>(<span class="params">self,params, encSecKey</span>):</span></span><br><span class="line">        url = <span class="string">&quot;https://music.163.com/weapi/song/enhance/player/url/v1?csrf_token=&quot;</span></span><br><span class="line">        payload = <span class="string">&#x27;params=&#x27;</span> + parse.quote(params) + <span class="string">&#x27;&amp;encSecKey=&#x27;</span> + parse.quote(encSecKey)</span><br><span class="line">        headers = &#123;</span><br><span class="line">            <span class="string">&#x27;authority&#x27;</span>: <span class="string">&#x27;music.163.com&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;user-agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;content-type&#x27;</span>: <span class="string">&#x27;application/x-www-form-urlencoded&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;accept&#x27;</span>: <span class="string">&#x27;*/*&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;origin&#x27;</span>: <span class="string">&#x27;https://music.163.com&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;sec-fetch-site&#x27;</span>: <span class="string">&#x27;same-origin&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;sec-fetch-mode&#x27;</span>: <span class="string">&#x27;cors&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;sec-fetch-dest&#x27;</span>: <span class="string">&#x27;empty&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;referer&#x27;</span>: <span class="string">&#x27;https://music.163.com/&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;accept-language&#x27;</span>: <span class="string">&#x27;zh-CN,zh;q=0.9&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">        response = requests.request(<span class="string">&quot;POST&quot;</span>, url, headers=headers, data=payload)</span><br><span class="line">        <span class="keyword">return</span> response.text</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">choice</span>(<span class="params">self,song_name_list,song_url_list,song_num</span>):</span></span><br><span class="line">        num = <span class="built_in">eval</span>(<span class="built_in">input</span>(<span class="string">&quot;请输入播放编号:&quot;</span>))</span><br><span class="line">        <span class="keyword">if</span>(num &lt; song_num):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;开始播放:&quot;</span>+song_name_list[num])</span><br><span class="line">            wb = webbrowser.get(<span class="string">&#x27;windows-default&#x27;</span>)</span><br><span class="line">            wb.<span class="built_in">open</span>(song_url_list[num])</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;编号错误&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">start</span>(<span class="params">self</span>):</span></span><br><span class="line">        song_url_list = []</span><br><span class="line">        song_name_list = []</span><br><span class="line">        song_num = <span class="number">0</span></span><br><span class="line">        song_search = <span class="built_in">input</span>(<span class="string">&#x27;请输入搜索目标,按回车键进行搜索:&#x27;</span>)</span><br><span class="line">        d = &#123;<span class="string">&quot;hlpretag&quot;</span>: <span class="string">&quot;&lt;span class=\&quot;s-fc7\&quot;&gt;&quot;</span>, <span class="string">&quot;hlposttag&quot;</span>: <span class="string">&quot;&lt;/span&gt;&quot;</span>, <span class="string">&quot;s&quot;</span>: song_search, <span class="string">&quot;type&quot;</span>: <span class="string">&quot;1&quot;</span>, <span class="string">&quot;offset&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">             <span class="string">&quot;total&quot;</span>: <span class="string">&quot;true&quot;</span>, <span class="string">&quot;limit&quot;</span>: <span class="string">&quot;30&quot;</span>, <span class="string">&quot;csrf_token&quot;</span>: <span class="string">&quot;&quot;</span>&#125;</span><br><span class="line">        d = json.dumps(d)</span><br><span class="line">        random_param = self.get_random()</span><br><span class="line">        param = self.get_final_param(d, random_param)</span><br><span class="line">        song_list = self.get_music_list(param[<span class="string">&#x27;params&#x27;</span>], param[<span class="string">&#x27;encSecKey&#x27;</span>])</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;搜索结果如下:&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(song_list) &gt; <span class="number">0</span>:</span><br><span class="line">            song_list = json.loads(song_list)[<span class="string">&#x27;result&#x27;</span>][<span class="string">&#x27;songs&#x27;</span>]</span><br><span class="line">            <span class="keyword">for</span> i, item <span class="keyword">in</span> <span class="built_in">enumerate</span>(song_list):</span><br><span class="line">                item = json.dumps(item)</span><br><span class="line">                song_name = json.loads(<span class="built_in">str</span>(item))[<span class="string">&#x27;name&#x27;</span>]</span><br><span class="line">                <span class="built_in">print</span>(<span class="built_in">str</span>(i) + <span class="string">&quot;：&quot;</span> + song_name)</span><br><span class="line">                d = &#123;<span class="string">&quot;ids&quot;</span>: <span class="string">&quot;[&quot;</span> + <span class="built_in">str</span>(json.loads(<span class="built_in">str</span>(item))[<span class="string">&#x27;id&#x27;</span>]) + <span class="string">&quot;]&quot;</span>, <span class="string">&quot;level&quot;</span>: <span class="string">&quot;standard&quot;</span>, <span class="string">&quot;encodeType&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">                     <span class="string">&quot;csrf_token&quot;</span>: <span class="string">&quot;&quot;</span>&#125;</span><br><span class="line">                d = json.dumps(d)</span><br><span class="line">                param = self.get_final_param(d, random_param)</span><br><span class="line">                song_info = self.get_reply(param[<span class="string">&#x27;params&#x27;</span>], param[<span class="string">&#x27;encSecKey&#x27;</span>])</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">len</span>(song_info) &gt; <span class="number">0</span>:</span><br><span class="line">                    song_info = json.loads(song_info)</span><br><span class="line">                    song_url = json.dumps(song_info[<span class="string">&#x27;data&#x27;</span>][<span class="number">0</span>][<span class="string">&#x27;url&#x27;</span>], ensure_ascii=<span class="literal">False</span>)</span><br><span class="line">                    song_name_list.append(song_name)</span><br><span class="line">                    song_url_list.append(song_url)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&quot;该首歌曲解析失败，可能是因为歌曲格式问题&quot;</span>)</span><br><span class="line">                song_num = i+<span class="number">1</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;一共搜索到&#123;&#125;个目标&quot;</span>.<span class="built_in">format</span>(song_num))</span><br><span class="line">            self.choice(song_name_list,song_url_list,song_num)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;很抱歉，未能搜索到相关歌曲信息&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    mus = Music()</span><br><span class="line">    mus.start()</span><br></pre></td></tr></table></figure>
<p>效果展示：</p>
<img src="/2022/05/19/%E7%99%BD%E5%AB%96%E7%BD%91%E6%98%93%E4%BA%91/1652932443142-1652970678978.png" class width="1652932443142"> 
<img src="/2022/05/19/%E7%99%BD%E5%AB%96%E7%BD%91%E6%98%93%E4%BA%91/1652932460709-1652970678978.png" class width="1652932460709"> 
<p>PS：有些歌曲要 VIP，这个我可破解不了，当然也播放不了</p>
<p>更新日志：</p>
<ul>
<li><p>version：v1.0</p>
</li>
<li><p>date：2022.5.19</p>
</li>
<li><p>type：</p>
<ul>
<li>Features：NULL</li>
<li>Changed：NULL</li>
<li>Removed：NULL</li>
</ul>
</li>
<li><p>desc：</p>
<ul>
<li>第一代版本，下一个版本打算加上 UI 界面，另外把 VIP 歌曲单独标记出来</li>
</ul>
</li>
</ul>
<h2 id="白嫖网易云-V1-1"><a href="#白嫖网易云-V1-1" class="headerlink" title="白嫖网易云_V1.1"></a>白嫖网易云_V1.1</h2><p>VIP 歌曲标记没有完成，但是 UI 界面做好了</p>
<ul>
<li>PS：还是不会并发，所以爬虫工作的时候UI界面会卡顿</li>
</ul>
<img src="/2022/05/19/%E7%99%BD%E5%AB%96%E7%BD%91%E6%98%93%E4%BA%91/1652970459276.png" class width="1652970459276"> 
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> parse</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> webbrowser</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> PyQt5 <span class="keyword">import</span> QtCore, QtGui, QtWidgets</span><br><span class="line"><span class="keyword">from</span> PyQt5.QtGui <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> PyQt5.QtCore <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> PyQt5.QtWidgets <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Music</span>():</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_random</span>(<span class="params">self</span>):</span></span><br><span class="line">        random_str = <span class="string">&#x27;&#x27;</span>.join(random.sample(string.ascii_letters + string.digits, <span class="number">16</span>))</span><br><span class="line">        <span class="keyword">return</span> random_str</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">len_change</span>(<span class="params">self,text</span>):</span></span><br><span class="line">        pad = <span class="number">16</span> - <span class="built_in">len</span>(text) % <span class="number">16</span></span><br><span class="line">        text = text + pad * <span class="built_in">chr</span>(pad)</span><br><span class="line">        text = text.encode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> text</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">aes</span>(<span class="params">self,text, key</span>):</span></span><br><span class="line">        iv = <span class="string">b&#x27;0102030405060708&#x27;</span></span><br><span class="line">        text = self.len_change(text)</span><br><span class="line">        cipher = AES.new(key.encode(), AES.MODE_CBC, iv)</span><br><span class="line">        encrypted = cipher.encrypt(text)</span><br><span class="line">        encrypt = base64.b64encode(encrypted).decode()</span><br><span class="line">        <span class="keyword">return</span> encrypt</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">b</span>(<span class="params">self,text, <span class="built_in">str</span></span>):</span></span><br><span class="line">        first_data = self.aes(text, <span class="string">&#x27;0CoJUm6Qyw8W8jud&#x27;</span>)</span><br><span class="line">        second_data = self.aes(first_data, <span class="built_in">str</span>)</span><br><span class="line">        <span class="keyword">return</span> second_data</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">c</span>(<span class="params">self,text</span>):</span></span><br><span class="line">        e = <span class="string">&#x27;010001&#x27;</span></span><br><span class="line">        f = <span class="string">&#x27;00e0b509f6259df8642dbc35662901477df22677ec152b5ff68ace615bb7b725152b3ab17a876aea8a5aa76d2e417629ec4ee341f56135fccf695280104e0312ecbda92557c93870114af6c9d05c4f7f0c3685b7a46bee255932575cce10b424d813cfe4875d3e82047b97ddef52741d546b8e289dc6935b3ece0462db0a22b8e7&#x27;</span></span><br><span class="line">        text = text[::-<span class="number">1</span>]</span><br><span class="line">        result = <span class="built_in">pow</span>(<span class="built_in">int</span>(binascii.hexlify(text.encode()), <span class="number">16</span>), <span class="built_in">int</span>(e, <span class="number">16</span>), <span class="built_in">int</span>(f, <span class="number">16</span>))</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">format</span>(result, <span class="string">&#x27;x&#x27;</span>).zfill(<span class="number">131</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_final_param</span>(<span class="params">self,text, <span class="built_in">str</span></span>):</span></span><br><span class="line">        params = self.b(text, <span class="built_in">str</span>)</span><br><span class="line">        encSecKey = self.c(<span class="built_in">str</span>)</span><br><span class="line">        <span class="keyword">return</span> &#123;<span class="string">&#x27;params&#x27;</span>: params, <span class="string">&#x27;encSecKey&#x27;</span>: encSecKey&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_music_list</span>(<span class="params">self,params, encSecKey</span>):</span></span><br><span class="line">        url = <span class="string">&quot;https://music.163.com/weapi/cloudsearch/get/web?csrf_token=&quot;</span></span><br><span class="line"></span><br><span class="line">        payload = <span class="string">&#x27;params=&#x27;</span> + parse.quote(params) + <span class="string">&#x27;&amp;encSecKey=&#x27;</span> + parse.quote(encSecKey)</span><br><span class="line">        headers = &#123;</span><br><span class="line">            <span class="string">&#x27;authority&#x27;</span>: <span class="string">&#x27;music.163.com&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;user-agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;content-type&#x27;</span>: <span class="string">&#x27;application/x-www-form-urlencoded&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;accept&#x27;</span>: <span class="string">&#x27;*/*&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;origin&#x27;</span>: <span class="string">&#x27;https://music.163.com&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;sec-fetch-site&#x27;</span>: <span class="string">&#x27;same-origin&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;sec-fetch-mode&#x27;</span>: <span class="string">&#x27;cors&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;sec-fetch-dest&#x27;</span>: <span class="string">&#x27;empty&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;referer&#x27;</span>: <span class="string">&#x27;https://music.163.com/search/&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;accept-language&#x27;</span>: <span class="string">&#x27;zh-CN,zh;q=0.9&#x27;</span>,</span><br><span class="line">        &#125;</span><br><span class="line">        response = requests.request(<span class="string">&quot;POST&quot;</span>, url, headers=headers, data=payload)</span><br><span class="line">        <span class="keyword">return</span> response.text</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_reply</span>(<span class="params">self,params, encSecKey</span>):</span></span><br><span class="line">        url = <span class="string">&quot;https://music.163.com/weapi/song/enhance/player/url/v1?csrf_token=&quot;</span></span><br><span class="line">        payload = <span class="string">&#x27;params=&#x27;</span> + parse.quote(params) + <span class="string">&#x27;&amp;encSecKey=&#x27;</span> + parse.quote(encSecKey)</span><br><span class="line">        headers = &#123;</span><br><span class="line">            <span class="string">&#x27;authority&#x27;</span>: <span class="string">&#x27;music.163.com&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;user-agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.135 Safari/537.36&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;content-type&#x27;</span>: <span class="string">&#x27;application/x-www-form-urlencoded&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;accept&#x27;</span>: <span class="string">&#x27;*/*&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;origin&#x27;</span>: <span class="string">&#x27;https://music.163.com&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;sec-fetch-site&#x27;</span>: <span class="string">&#x27;same-origin&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;sec-fetch-mode&#x27;</span>: <span class="string">&#x27;cors&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;sec-fetch-dest&#x27;</span>: <span class="string">&#x27;empty&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;referer&#x27;</span>: <span class="string">&#x27;https://music.163.com/&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;accept-language&#x27;</span>: <span class="string">&#x27;zh-CN,zh;q=0.9&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">        response = requests.request(<span class="string">&quot;POST&quot;</span>, url, headers=headers, data=payload)</span><br><span class="line">        <span class="keyword">return</span> response.text</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">start</span>(<span class="params">self,song_search</span>):</span></span><br><span class="line">        song_url_list = []</span><br><span class="line">        song_name_list = []</span><br><span class="line">        song_num = <span class="number">0</span></span><br><span class="line">        d = &#123;<span class="string">&quot;hlpretag&quot;</span>: <span class="string">&quot;&lt;span class=\&quot;s-fc7\&quot;&gt;&quot;</span>, <span class="string">&quot;hlposttag&quot;</span>: <span class="string">&quot;&lt;/span&gt;&quot;</span>, <span class="string">&quot;s&quot;</span>: song_search, <span class="string">&quot;type&quot;</span>: <span class="string">&quot;1&quot;</span>, <span class="string">&quot;offset&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">             <span class="string">&quot;total&quot;</span>: <span class="string">&quot;true&quot;</span>, <span class="string">&quot;limit&quot;</span>: <span class="string">&quot;30&quot;</span>, <span class="string">&quot;csrf_token&quot;</span>: <span class="string">&quot;&quot;</span>&#125;</span><br><span class="line">        d = json.dumps(d)</span><br><span class="line">        random_param = self.get_random()</span><br><span class="line">        param = self.get_final_param(d, random_param)</span><br><span class="line">        song_list = self.get_music_list(param[<span class="string">&#x27;params&#x27;</span>], param[<span class="string">&#x27;encSecKey&#x27;</span>])</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;搜索结果如下:&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(song_list) &gt; <span class="number">0</span>:</span><br><span class="line">            song_list = json.loads(song_list)[<span class="string">&#x27;result&#x27;</span>][<span class="string">&#x27;songs&#x27;</span>]</span><br><span class="line">            <span class="keyword">for</span> i, item <span class="keyword">in</span> <span class="built_in">enumerate</span>(song_list):</span><br><span class="line">                item = json.dumps(item)</span><br><span class="line">                song_name = json.loads(<span class="built_in">str</span>(item))[<span class="string">&#x27;name&#x27;</span>]</span><br><span class="line">                <span class="built_in">print</span>(<span class="built_in">str</span>(i) + <span class="string">&quot;：&quot;</span> + song_name)</span><br><span class="line">                d = &#123;<span class="string">&quot;ids&quot;</span>: <span class="string">&quot;[&quot;</span> + <span class="built_in">str</span>(json.loads(<span class="built_in">str</span>(item))[<span class="string">&#x27;id&#x27;</span>]) + <span class="string">&quot;]&quot;</span>, <span class="string">&quot;level&quot;</span>: <span class="string">&quot;standard&quot;</span>, <span class="string">&quot;encodeType&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">                     <span class="string">&quot;csrf_token&quot;</span>: <span class="string">&quot;&quot;</span>&#125;</span><br><span class="line">                d = json.dumps(d)</span><br><span class="line">                param = self.get_final_param(d, random_param)</span><br><span class="line">                song_info = self.get_reply(param[<span class="string">&#x27;params&#x27;</span>], param[<span class="string">&#x27;encSecKey&#x27;</span>])</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">len</span>(song_info) &gt; <span class="number">0</span>:</span><br><span class="line">                    song_info = json.loads(song_info)</span><br><span class="line">                    song_url = json.dumps(song_info[<span class="string">&#x27;data&#x27;</span>][<span class="number">0</span>][<span class="string">&#x27;url&#x27;</span>], ensure_ascii=<span class="literal">False</span>)</span><br><span class="line">                    song_name_list.append(song_name)</span><br><span class="line">                    song_url_list.append(song_url)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&quot;该首歌曲解析失败，可能是因为歌曲格式问题&quot;</span>)</span><br><span class="line">                song_num = i+<span class="number">1</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;一共搜索到&#123;&#125;个目标&quot;</span>.<span class="built_in">format</span>(song_num))</span><br><span class="line">            <span class="keyword">return</span> song_name_list,song_url_list</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MainWin</span>(<span class="params">QtWidgets.QWidget</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self,parent=<span class="literal">None</span></span>):</span></span><br><span class="line">        <span class="built_in">super</span>(MainWin, self).__init__(parent)</span><br><span class="line">        self.song_result = <span class="string">&quot;&quot;</span></span><br><span class="line">        self.song_num = <span class="number">0</span></span><br><span class="line">        self.layout = QGridLayout()</span><br><span class="line">        self.setWindowFlags(Qt.SubWindow)</span><br><span class="line">        self.setupUI()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">searchMusic</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;* searchMusic &#x27;</span>)</span><br><span class="line">        self.song_name_list = []</span><br><span class="line">        self.song_url_list = []</span><br><span class="line">        self.song_num = <span class="number">0</span></span><br><span class="line">        self.song_result = <span class="string">&quot;&quot;</span></span><br><span class="line">        self.song_search = self.searchBox.text()</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(self.song_search) == <span class="number">0</span>:</span><br><span class="line">            self.resultText.setText(<span class="string">&quot;请先输入歌曲名称&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        mus = Music()</span><br><span class="line">        self.song_name_list,self.song_url_list=mus.start(self.song_search)</span><br><span class="line">        <span class="keyword">for</span> song_name <span class="keyword">in</span> self.song_name_list:</span><br><span class="line">            self.song_num += <span class="number">1</span></span><br><span class="line">            self.song_result+=(<span class="built_in">str</span>(self.song_num)+<span class="string">&quot;.&quot;</span>+<span class="built_in">str</span>(song_name)+<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">        self.song_result=self.song_result[:-<span class="number">1</span>]</span><br><span class="line">        self.resultText.setText(self.song_result)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">choiceMusic</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;* choiceMusic &#x27;</span>)</span><br><span class="line">        self.song_choice = self.choiceBox.text()</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(self.song_choice) == <span class="number">0</span>:</span><br><span class="line">            self.resultText.setText(<span class="string">&quot;请先输入编号&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        self.song_choice = <span class="built_in">eval</span>(self.song_choice)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(self.song_result) == <span class="number">0</span>:</span><br><span class="line">            self.resultText.setText(<span class="string">&quot;请先搜索歌曲&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        <span class="keyword">if</span> self.song_choice &gt; self.song_num:</span><br><span class="line">            self.resultText.setText(<span class="string">&quot;输入的编号有误&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        self.resultText.setText(<span class="string">&quot;开始播放:&#123;&#125;&quot;</span>.<span class="built_in">format</span>(self.song_name_list[self.song_choice-<span class="number">1</span>]))</span><br><span class="line">        wb = webbrowser.get(<span class="string">&#x27;windows-default&#x27;</span>)</span><br><span class="line">        wb.<span class="built_in">open</span>(self.song_url_list[self.song_choice-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">quitWindows</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;* quitWindows &#x27;</span>)</span><br><span class="line">        self.close()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">setupUI</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.resize(<span class="number">550</span>,<span class="number">450</span>)</span><br><span class="line">        self.groupBox = QtWidgets.QGroupBox(self)</span><br><span class="line">        self.groupBox.setGeometry(QtCore.QRect(<span class="number">10</span>,<span class="number">10</span>,<span class="number">530</span>,<span class="number">430</span>))</span><br><span class="line">        self.groupBox.setObjectName(<span class="string">&quot;groupBox&quot;</span>)</span><br><span class="line">        self.groupBox.setStyleSheet(<span class="string">&quot;color:white&quot;</span>)</span><br><span class="line">        self.searchBox = QtWidgets.QLineEdit(self.groupBox)</span><br><span class="line">        self.searchBox.setGeometry(QtCore.QRect(<span class="number">105</span>,<span class="number">25</span>,<span class="number">160</span>,<span class="number">20</span>))</span><br><span class="line">        self.searchBox.setObjectName(<span class="string">&quot;searchBox&quot;</span>)</span><br><span class="line">        self.searchBox.setStyleSheet(<span class="string">&quot;color:black&quot;</span>)</span><br><span class="line">        self.choiceBox = QtWidgets.QLineEdit(self.groupBox)</span><br><span class="line">        self.choiceBox.setGeometry(QtCore.QRect(<span class="number">105</span>,<span class="number">315</span>,<span class="number">160</span>,<span class="number">20</span>))</span><br><span class="line">        self.choiceBox.setObjectName(<span class="string">&quot;choiceBox&quot;</span>)</span><br><span class="line">        self.choiceBox.setStyleSheet(<span class="string">&quot;color:black&quot;</span>)</span><br><span class="line">        self.resultText = QtWidgets.QTextEdit(self.groupBox)</span><br><span class="line">        self.resultText.setGeometry(QtCore.QRect(<span class="number">20</span>,<span class="number">60</span>,<span class="number">260</span>,<span class="number">240</span>))</span><br><span class="line">        self.resultText.setObjectName(<span class="string">&quot;resultText&quot;</span>)</span><br><span class="line">        self.resultText.setFont(QFont(<span class="string">&quot;微软雅黑&quot;</span>,<span class="number">10</span>,QFont.Bold))</span><br><span class="line">        self.resultText.setStyleSheet(<span class="string">&quot;color:black&quot;</span>)</span><br><span class="line">        self.label = QtWidgets.QLabel(self.groupBox)</span><br><span class="line">        self.label.setGeometry(QtCore.QRect(<span class="number">20</span>,<span class="number">20</span>,<span class="number">80</span>,<span class="number">30</span>))</span><br><span class="line">        self.label.setObjectName(<span class="string">&quot;laber&quot;</span>)</span><br><span class="line">        self.label2 = QtWidgets.QLabel(self.groupBox)</span><br><span class="line">        self.label2.setGeometry(QtCore.QRect(<span class="number">15</span>,<span class="number">20</span>,<span class="number">80</span>,<span class="number">610</span>))</span><br><span class="line">        self.label2.setObjectName(<span class="string">&quot;laber2&quot;</span>)</span><br><span class="line">        self.searchButton = QtWidgets.QPushButton(self)</span><br><span class="line">        self.searchButton.setGeometry(QtCore.QRect(<span class="number">50</span>,<span class="number">380</span>,<span class="number">90</span>,<span class="number">30</span>))</span><br><span class="line">        self.searchButton.setObjectName(<span class="string">&quot;searchButton&quot;</span>)</span><br><span class="line">        self.choiceButton = QtWidgets.QPushButton(self)</span><br><span class="line">        self.choiceButton.setGeometry(QtCore.QRect(<span class="number">160</span>,<span class="number">380</span>,<span class="number">90</span>,<span class="number">30</span>))</span><br><span class="line">        self.choiceButton.setObjectName(<span class="string">&quot;choiceButton&quot;</span>)</span><br><span class="line">        self.quitButton = QtWidgets.QPushButton(self)</span><br><span class="line">        self.quitButton.setGeometry(QtCore.QRect(<span class="number">270</span>,<span class="number">380</span>,<span class="number">90</span>,<span class="number">30</span>))</span><br><span class="line">        self.quitButton.setObjectName(<span class="string">&quot;quitButton&quot;</span>)</span><br><span class="line"></span><br><span class="line">        self.retranslateUI()</span><br><span class="line">        self.searchButton.clicked.connect(self.searchMusic)</span><br><span class="line">        self.choiceButton.clicked.connect(self.choiceMusic)</span><br><span class="line">        self.quitButton.clicked.connect(self.quitWindows)</span><br><span class="line"></span><br><span class="line">        QtCore.QMetaObject.connectSlotsByName(self)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">retranslateUI</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.setWindowTitle(<span class="string">&quot;网易云API&quot;</span>)</span><br><span class="line">        self.groupBox.setTitle(<span class="string">&quot;输入搜索的目标&quot;</span>)</span><br><span class="line">        self.label.setText(<span class="string">&quot;歌曲&amp;歌手&quot;</span>)</span><br><span class="line">        self.label2.setText(<span class="string">&quot;请输入编号&quot;</span>)</span><br><span class="line">        self.searchButton.setText(<span class="string">&quot;搜索&quot;</span>)</span><br><span class="line">        self.choiceButton.setText(<span class="string">&quot;播放&quot;</span>)</span><br><span class="line">        self.quitButton.setText(<span class="string">&quot;退出&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app = QtWidgets.QApplication(sys.argv)</span><br><span class="line">    win = MainWin()</span><br><span class="line">    palette = QPalette()</span><br><span class="line">    palette.setBrush(QPalette.Background, QBrush(QPixmap(<span class="string">&quot;D:\PythonProject\images\YHellow.png&quot;</span>)))</span><br><span class="line">    win.setPalette(palette)</span><br><span class="line">    win.show()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure>
<p>更新日志：</p>
<ul>
<li><p>version：v1.1</p>
</li>
<li><p>date：2022.5.20</p>
</li>
<li><p>type：</p>
<ul>
<li>Features：<ul>
<li>全新的 UI 界面</li>
</ul>
</li>
<li>Changed：NULL</li>
<li>Removed：NULL</li>
</ul>
</li>
<li><p>desc：</p>
<ul>
<li>本项目已相对完善，暂时不会更新了</li>
</ul>
</li>
</ul>

    </div>

    
    
    

      <footer class="post-footer">
          
          <div class="post-tags">
              <a href="/tags/Netease/" rel="tag"><i class="fa fa-tag"></i> Netease</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2022/05/17/kernel%20UAF/" rel="prev" title="kernel UAF">
      <i class="fa fa-chevron-left"></i> kernel UAF
    </a></div>
      <div class="post-nav-item">
    <a href="/2022/05/21/kernel%20attack/" rel="next" title="kernel attack（持续更新）">
      kernel attack（持续更新） <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%A1%B9%E7%9B%AE%E5%88%86%E6%9E%90"><span class="nav-number">1.</span> <span class="nav-text">项目分析</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%99%BD%E5%AB%96%E7%BD%91%E6%98%93%E4%BA%91-V1-0"><span class="nav-number">2.</span> <span class="nav-text">白嫖网易云_V1.0</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%99%BD%E5%AB%96%E7%BD%91%E6%98%93%E4%BA%91-V1-1"><span class="nav-number">3.</span> <span class="nav-text">白嫖网易云_V1.1</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="yhellow"
      src="/images/avatar.gif">
  <p class="site-author-name" itemprop="name">yhellow</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">329</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">13</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">170</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2019 – 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">yhellow</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="Symbols count total">4.9m</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="Reading time total">74:32</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

  

</body>
</html>
